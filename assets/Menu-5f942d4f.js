import{o as G,r as F,g as H,b as _,c as r,d as N,e as M,f as V,h as e,w as t,l as c,n as J,i as m,F as K,k as P,p as f,v as b,m as W}from"./index-8a49950e.js";const X={class:"user-manage"},Y={class:"query-form"},Z={class:"base-table"},ee={class:"action"},le=V("span",null,"不选，则直接创建一级菜单",-1),oe={class:"dialog-footer"},ne={__name:"Menu",setup(te){G(()=>{w()});let s=F(!1);const y=F(null);let k="";const{proxy:g}=H();let p=_({menuName:"",menuState:1});const B=_({menuName:[{required:!0,message:"请输入菜单名称",trigger:["blur"]},{min:2,max:10,message:"长度2-10字符",trigger:["blur"]}]}),C=_([]),a=_({parentId:[null],menuType:1,menuState:1}),L=_([{label:"菜单名称",prop:"menuName",width:260},{label:"图标",prop:"icon"},{label:"菜单类型",prop:"menuType",formatter(n,l,u){return{1:"菜单",2:"按钮"}[u]}},{label:"权限标识",prop:"menuCode"},{label:"路由地址",prop:"path"},{label:"组件路径",prop:"component"},{label:"菜单状态",prop:"menuState",formatter(n,l,u){return{1:"正常",2:"停用"}[u]},width:"60"},{label:"创建时间",prop:"createTime",formatter(n,l,u){return u.substring(0,10)}}]),w=async()=>{try{(await g.$api.getMenuList(p)).forEach(l=>{C.push(l)})}catch(n){throw new n}},q=()=>{},h=n=>{p=Object.assign(p,{menuName:"",menuState:1})},S=(n,l)=>{s.value=!0,k="add",n===1||n===2&&(a.parentId=[...l.parentId,l._id].filter(u=>u))},z=n=>{console.log(n),s.value=!0,k="edit",console.log({...n}),Object.assign(a,n)},E=()=>{g.$message.success("删除成功"),w()},j=()=>{s.value=!1,h(y.value)},D=()=>{y.value.validate(async n=>{if(n){let l={...a,action:k};await g.$api.menuSubmit(l),s.value=!1,g.$message.success("添加成功"),h(y.value),w()}})};return(n,l)=>{const u=r("el-input"),d=r("el-form-item"),T=r("el-option"),O=r("el-select"),i=r("el-button"),U=r("el-form"),$=r("el-table-column"),R=r("el-table"),A=r("el-cascader"),v=r("el-radio"),I=r("el-radio-group"),Q=r("el-dialog");return N(),M("div",X,[V("div",Y,[e(U,{inline:!0,model:c(p),ref:"form"},{default:t(()=>[e(d,{label:"菜单名称",prop:"menuName"},{default:t(()=>[e(u,{modelValue:c(p).menuName,"onUpdate:modelValue":l[0]||(l[0]=o=>c(p).menuName=o),placeholder:"请输入菜单名称"},null,8,["modelValue"])]),_:1}),e(d,{label:"用户名称",prop:"menuState"},{default:t(()=>[e(O,{modelValue:c(p).menuState,"onUpdate:modelValue":l[1]||(l[1]=o=>c(p).menuState=o),placeholder:"请输入菜单状态"},{default:t(()=>[e(T,{value:1,label:"正常"}),e(T,{value:2,label:"停用"})]),_:1},8,["modelValue"])]),_:1}),e(d,null,{default:t(()=>[e(i,{type:"primary",onClick:q},{default:t(()=>[m("查询")]),_:1}),e(i,{onClick:l[2]||(l[2]=o=>h(n.form))},{default:t(()=>[m("重置")]),_:1})]),_:1})]),_:1},8,["model"])]),V("div",Z,[V("div",ee,[e(i,{type:"primary",onClick:l[3]||(l[3]=o=>S(1))},{default:t(()=>[m("新增")]),_:1})]),e(R,{data:C,style:{width:"100%"},"row-key":"_id"},{default:t(()=>[(N(!0),M(K,null,P(L,o=>(N(),W($,{key:o.prop,prop:o.prop,label:o.label,formatter:o.formatter},null,8,["prop","label","formatter"]))),128)),e($,{label:"操作",width:"200"},{default:t(o=>[e(i,{size:"small",type:"primary",onClick:x=>S(2,o.row)},{default:t(()=>[m("新增")]),_:2},1032,["onClick"]),e(i,{size:"small",type:"primary",onClick:x=>z(o.row)},{default:t(()=>[m("编辑")]),_:2},1032,["onClick"]),e(i,{type:"danger",size:"small",onClick:x=>E(o.row)},{default:t(()=>[m("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),e(Q,{modelValue:c(s),"onUpdate:modelValue":l[12]||(l[12]=o=>J(s)?s.value=o:s=o),title:"用户新增"},{footer:t(()=>[V("span",oe,[e(i,{onClick:j},{default:t(()=>[m("取消")]),_:1}),e(i,{type:"primary",onClick:D},{default:t(()=>[m(" 确认 ")]),_:1})])]),default:t(()=>[e(U,{ref_key:"dialogForm",ref:y,model:a,"label-width":"100px",rules:B},{default:t(()=>[e(d,{label:"父级菜单",prop:"parentId"},{default:t(()=>[e(A,{modelValue:a.parentId,"onUpdate:modelValue":l[4]||(l[4]=o=>a.parentId=o),options:C,props:{checkStrictly:!0,value:"_id",label:"menuName"},clearable:""},null,8,["modelValue","options"]),le]),_:1}),e(d,{label:"菜单类型",prop:"menuType"},{default:t(()=>[e(I,{modelValue:a.menuType,"onUpdate:modelValue":l[5]||(l[5]=o=>a.menuType=o)},{default:t(()=>[e(v,{label:1},{default:t(()=>[m("菜单")]),_:1}),e(v,{label:2},{default:t(()=>[m("按钮")]),_:1})]),_:1},8,["modelValue"])]),_:1}),f(e(d,{label:"菜单名称",prop:"menuName"},{default:t(()=>[e(u,{modelValue:a.menuName,"onUpdate:modelValue":l[6]||(l[6]=o=>a.menuName=o),placeholder:"请输入菜单名称"},null,8,["modelValue"])]),_:1},512),[[b,a.menuType==1]]),f(e(d,{label:"菜单图标",prop:"icon"},{default:t(()=>[e(u,{modelValue:a.icon,"onUpdate:modelValue":l[7]||(l[7]=o=>a.icon=o),placeholder:"请输入菜单图标"},null,8,["modelValue"])]),_:1},512),[[b,a.menuType==1]]),e(d,{label:"路由地址",prop:"path"},{default:t(()=>[e(u,{modelValue:a.path,"onUpdate:modelValue":l[8]||(l[8]=o=>a.path=o),placeholder:"请输入路由地址"},null,8,["modelValue"])]),_:1}),f(e(d,{label:"权限标识",prop:"menuCode"},{default:t(()=>[e(u,{modelValue:a.menuCode,"onUpdate:modelValue":l[9]||(l[9]=o=>a.menuCode=o),placeholder:"请输入权限标识"},null,8,["modelValue"])]),_:1},512),[[b,a.menuType==2]]),f(e(d,{label:"组件路径",prop:"component"},{default:t(()=>[e(u,{modelValue:a.component,"onUpdate:modelValue":l[10]||(l[10]=o=>a.component=o),placeholder:"请输入组件路径"},null,8,["modelValue"])]),_:1},512),[[b,a.menuType==1]]),f(e(d,{label:"菜单状态",prop:"menuState"},{default:t(()=>[e(I,{modelValue:a.menuState,"onUpdate:modelValue":l[11]||(l[11]=o=>a.menuState=o)},{default:t(()=>[e(v,{label:1},{default:t(()=>[m("正常")]),_:1}),e(v,{label:2},{default:t(()=>[m("停用")]),_:1})]),_:1},8,["modelValue"])]),_:1},512),[[b,a.menuType==1]])]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])])}}};export{ne as default};
